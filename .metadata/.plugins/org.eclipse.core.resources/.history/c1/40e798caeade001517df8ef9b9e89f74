<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.his.dao.baseinfo.SurgeryInformationServiceMapDao" >
  <resultMap id="BaseResultMap" type="com.his.entity.baseinfo.SurgeryInformationServiceMap" >
    <id column="SurgeryServiceMapID" property="surgeryservicemapid" jdbcType="INTEGER" />
    <association property="surgeryInformation" column="SurgeryInfID" select="com.his.dao.baseinfo.SurgeryInformationDao.selectByPrimaryKey"></association>
  	<association property="serviceItem" column="ServiceItemID" select="com.his.dao.baseinfo.ServiceItemDao.selectByPrimaryKey"></association>
    
  </resultMap>
  <delete id="delete" parameterType="Map">
	delete from SurgeryInformationServiceMap
	<where>
		<if test="serviceitemid!=null and serviceitemid!=''">
			and ServiceItemID=#{serviceitemid,jdbcType=CHAR}
		</if>
		<if test="surgeryinfid!=null and surgeryinfid!=''">
			and SurgeryInfID = #{surgeryinfid,jdbcType=VARCHAR}
		</if>
	</where>
  </delete>
  
  <delete id="deleteBySurgeryInfID" parameterType="String">
    delete from SurgeryInformationServiceMap
    where ( SurgeryInfID=#{surgeryinfid} )
  </delete>
  
   <delete id="deleteByPrimaryKey" parameterType="Integer">
    delete from SurgeryInformationServiceMap where SurgeryServiceMapID=#{surgeryservicemapid}
  </delete>
  
  <insert id="insert" parameterType="com.his.entity.baseinfo.SurgeryInformationServiceMap">
    insert into SurgeryInformationServiceMap (SurgeryInfID,ServiceItemID)
    values (#{surgeryInformation.surgeryinfid,jdbcType=VARCHAR},#{serviceItem.serviceitemid,jdbcType=CHAR})
  </insert>
  
  <select id="findSurgeryInformationServiceMap" parameterType="Map" resultMap="BaseResultMap">
		select * from SurgeryInformationServiceMap
		<where>
			<!-- 查询某个手术分类拥有的角色 -->
			<if test="surgeryinfid!=null and surgeryinfid!=''">
				and SurgeryInfID=#{surgeryinfid}
			</if>
			<!-- surgeryinfid & serviceitemid 都存在时，查询某映射关系是否存在 -->
			<if test="serviceitemid!=null and serviceitemid!=''">
				and ServiceItemID=#{serviceitemid}
			</if>
		</where>
		<if test="start!=null and size!=null">
			order by SurgeryServiceMapID offset ${start} rows fetch next ${size} rows only
		</if>
  </select>
</mapper>