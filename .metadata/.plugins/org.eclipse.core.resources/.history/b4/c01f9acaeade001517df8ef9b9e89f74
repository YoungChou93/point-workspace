<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.his.dao.baseinfo.TestInformationServiceMapDao">
	<resultMap id="BaseResultMap"
		type="com.his.entity.baseinfo.TestInformationServiceMap">
		<id column="TestServiceMapID" property="testservicemapid" jdbcType="INTEGER" />
		<association property="testInformation" column="TestInfID"
			select="com.his.dao.baseinfo.TestInformationDao.selectByPrimaryKey"></association>
		<association property="serviceItem" column="ServiceItemID"
			select="com.his.dao.baseinfo.ServiceItemDao.selectByPrimaryKey"></association>

	</resultMap>
	<delete id="delete" parameterType="Map">
		delete from TestInformationServiceMap
		<where>
			<if test="serviceitemid!=null and serviceitemid!=''">
				and ServiceItemID=#{serviceitemid,jdbcType=CHAR}
			</if>
			<if test="testinfid!=null and testinfid!=''">
				and TestInfID = #{testinfid,jdbcType=VARCHAR}
			</if>
		</where>
	</delete>

	<delete id="deleteByTestInfID" parameterType="String">
		delete from TestInformationServiceMap
		where ( TestInfID=#{testinfid} )
	</delete>

	<delete id="deleteByPrimaryKey" parameterType="Integer">
		delete from TestInformationServiceMap where
		TestServiceMapID=#{testservicemapid}
	</delete>

	<insert id="insert" parameterType="com.his.entity.baseinfo.TestInformationServiceMap">
		insert into TestInformationServiceMap (TestInfID,ServiceItemID)
		values
		(#{testInformation.testinfid,jdbcType=VARCHAR},#{serviceItem.serviceitemid,jdbcType=CHAR})
	</insert>

	<select id="findTestInformationServiceMap" parameterType="Map"
		resultMap="BaseResultMap">
		select * from TestInformationServiceMap
		<where>
			<!-- 查询某个检查分类拥有的角色 -->
			<if test="testinfid!=null and testinfid!=''">
				and TestInfID=#{testinfid}
			</if>
			<!-- testinfid & serviceitemid 都存在时，查询某映射关系是否存在 -->
			<if test="serviceitemid!=null and serviceitemid!=''">
				and ServiceItemID=#{serviceitemid}
			</if>
		</where>
		<if test="start!=null and size!=null">
			order by TestServiceMapID offset ${start} rows fetch next
			${size} rows only
		</if>
	</select>
</mapper>