<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.his.dao.drugrepo.DrugRepoInputDao">
	<resultMap id="BaseResultMap" type="com.his.entity.drugrepo.DrugRepoInput">
		<id column="InputID" property="inputid" jdbcType="CHAR" />
		<result column="InputNumber" property="inputnumber" jdbcType="DECIMAL" />
		<result column="InputPrice" property="inputprice" jdbcType="DECIMAL" />
		<result column="RetailPrice" property="retailprice" jdbcType="DECIMAL" />
		<result column="InputTime" property="inputtime" jdbcType="TIMESTAMP" />
		<result column="InputState" property="inputstate" jdbcType="INTEGER" />
		<result column="InputType" property="inputtype" jdbcType="INTEGER" />
		<result column="PlanID" property="planid" jdbcType="CHAR" />
		
		<result column="InvoiceCode" property="invoicecode" jdbcType="NVARCHAR" />
		<result column="LimitTime" property="limittime" jdbcType="DATE" />

		<association column="DeptID" property="department"
			select="com.his.dao.baseinfo.DepartmentDao.selectPartByPrimaryKey"></association>
		<association column="ExecuteEmpID" property="executeemployee"
			select="com.his.dao.baseinfo.EmployeeDao.selectPartByPrimaryKey"></association>
		<association column="MedicineID" property="medicine"
			select="com.his.dao.baseinfo.MedicineBaseInfoDao.selectPartByPrimaryKey"></association>
		<association column="FactoryID" property="factoryinfo"
			select="com.his.dao.drugrepo.FactoryInfoDao.selectPartByPrimaryKey"></association>
		<association column="ShopID" property="shopinfo"
			select="com.his.dao.drugrepo.ShopInfoDao.selectByPrimaryKey"></association>
		<association column="BillCode" property="billcode"
			select="com.his.dao.drugrepo.BillRecDao.selectByPrimaryKey"></association>
	</resultMap>

	<sql id="Base_Column_List">
		InputID, MedicineID, InputNumber, InputPrice, RetailPrice,
		InputTime,
		ExecuteEmpID, DeptID, InputState, InputType, PlanID, BillCode,
		InvoiceCode, LimitTime, FactoryID, ShopID 
	</sql>

	<delete id="deleteByPrimaryKey" parameterType="java.lang.String">
		delete from DrugRepoInput
		where InputID = #{inputid,jdbcType=CHAR}
	</delete>

	<delete id="deleteByMap" parameterType="Map">
		delete from DrugRepoInput
		<where>
			<if test="inputid !=null and inputid !=''">
				and InputID=#{inputid}
			</if>
		</where>
	</delete>

	<insert id="insertSelective" parameterType="com.his.entity.drugrepo.DrugRepoInput">
		insert into DrugRepoInput
		<trim prefix="(" suffix=")" suffixOverrides=",">
			<if test="inputid != null">
				InputID,
			</if>
			<if test="medicine != null">
				MedicineID,
			</if>
			<if test="inputnumber != null">
				InputNumber,
			</if>
			<if test="inputprice != null">
				InputPrice,
			</if>
			<if test="retailprice != null">
				RetailPrice,
			</if>
			<if test="inputtime != null">
				InputTime,
			</if>
			<if test="executeemployee != null">
				ExecuteEmpID,
			</if>
			<if test="department != null">
				DeptID,
			</if>
			<if test="inputstate != null">
				InputState,
			</if>
			<if test="inputtype != null">
				InputType,
			</if>
			<if test="planid != null">
				PlanID,
			</if>
			<if test="billcode != null">
				BillCode,
			</if>
			<if test="invoicecode != null">
				InvoiceCode,
			</if>
			<if test="limittime != null">
				LimitTime,
			</if>
			<if test="factoryinfo != null">
				FactoryID,
			</if>
			<if test="shopinfo != null">
				ShopID,
			</if>
		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
			<if test="inputid != null">
				#{inputid,jdbcType=CHAR},
			</if>
			<if test="medicine != null">
				#{medicine.medicineid,jdbcType=CHAR},
			</if>
			<if test="inputnumber != null">
				#{inputnumber,jdbcType=DECIMAL},
			</if>
			<if test="inputprice != null">
				#{inputprice,jdbcType=DECIMAL},
			</if>
			<if test="retailprice != null">
				#{retailprice,jdbcType=DECIMAL},
			</if>
			<if test="inputtime != null">
				#{inputtime,jdbcType=TIMESTAMP},
			</if>
			<if test="executeemployee != null">
				#{executeemployee.empid,jdbcType=CHAR},
			</if>
			<if test="department != null">
				#{department.deptid,jdbcType=CHAR},
			</if>
			<if test="inputstate != null">
				#{inputstate,jdbcType=INTEGER},
			</if>
			<if test="inputtype != null">
				#{inputtype,jdbcType=INTEGER},
			</if>
			<if test="planid != null">
				#{planid,jdbcType=CHAR},
			</if>
			<if test="billcode != null">
				#{billcode.billrecid,jdbcType=CHAR},
			</if>
			<if test="invoicecode != null">
				#{invoicecode,jdbcType=NVARCHAR},
			</if>
			<if test="limittime != null">
				#{limittime,jdbcType=DATE},
			</if>
			<if test="factoryinfo != null">
				#{factoryinfo.factoryid,jdbcType=CHAR},
			</if>
			<if test="shopinfo != null">
				#{shopinfo.shopid,jdbcType=CHAR},
			</if>
		</trim>
	</insert>

	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from DrugRepoInput
		where InputID = #{inputid,jdbcType=CHAR}
	</select>
	
	<select id="selectByMap" parameterType="Map">
		select * from DrugRepoInput
		<where>
			<if test="inputid !=null and inputid !=''">
				and InputID = #{inputid}
			</if>
		</where>
	</select>
	

	<update id="updateByPrimaryKeySelective" parameterType="com.his.entity.drugrepo.DrugRepoInput">
		update DrugRepoInput
		<set>
			<if test="medicine != null">
				MedicineID = #{medicine.medicineid,jdbcType=CHAR},
			</if>
			<if test="inputnumber != null">
				InputNumber = #{inputnumber,jdbcType=DECIMAL},
			</if>
			<if test="inputprice != null">
				InputPrice = #{inputprice,jdbcType=DECIMAL},
			</if>
			<if test="retailprice != null">
				RetailPrice = #{retailprice,jdbcType=DECIMAL},
			</if>
			<if test="inputtime != null">
				InputTime = #{inputtime,jdbcType=TIMESTAMP},
			</if>
			<if test="executeemployee != null">
				ExecuteEmpID = #{executeemployee.empid,jdbcType=CHAR},
			</if>
			<if test="department != null">
				DeptID = #{department.deptid,jdbcType=CHAR},
			</if>
			<if test="inputstate != null">
				InputState = #{inputstate,jdbcType=INTEGER},
			</if>
			<if test="inputtype != null">
				InputType = #{inputtype,jdbcType=INTEGER},
			</if>
			<if test="planid != null">
				PlanID = #{planid,jdbcType=CHAR},
			</if>
			<if test="billcode != null">
				BillCode = #{billcode.billrecid,jdbcType=CHAR},
			</if>
			<if test="invoicecode != null">
				InvoiceCode = #{invoicecode,jdbcType=NVARCHAR},
			</if>
			<if test="limittime != null">
				LimitTime = #{limittime,jdbcType=DATE},
			</if>
			<if test="factoryinfo != null">
				FactoryID = #{factoryinfo.factoryid,jdbcType=CHAR},
			</if>
			<if test="shopinfo != null">
				ShopID = #{shopinfo.shopid,jdbcType=CHAR},
			</if>
		</set>
		where InputID = #{inputid,jdbcType=CHAR}
	</update>

	<select id="findDrugRepoInput" parameterType="Map" resultMap="BaseResultMap">
		select * from DrugRepoInput
		<where>
			<!-- 根据入库药品查询入库记录 -->
			<if test="medicineid !=null and medicineid !=''">
				and MedicineID like #{medicineid}
			</if>
			<!-- 根据入库操作员查询入库记录 -->
			<if test="executeempid !=null and executeempid !=''">
				and ExecuteEmpID like #{executeempid}
			</if>
			<if test="billcode !=null and billcode !=''">
				and BillCode = #{billcode}
			</if>
			<if test="inputstate !=null ">
				and InputState = #{inputstate}
			</if>
		</where>
		<if test="start!=null and size!=null">
			order by InputID DESC offset ${start} rows fetch next
			${size} rows only
		</if>
	</select>

	<select id="getTotalDrugRepoInput" parameterType="Map"
		resultType="Long">
		select count(*) from DrugRepoInput
		<where>
			<!-- 根据入库药品查询入库记录 -->
			<if test="medicineid !=null and medicineid !=''">
				and MedicineID like #{medicineid}
			</if>
			<!-- 根据入库操作员查询入库记录 -->
			<if test="executeempid !=null and executeempid !=''">
				and ExecuteEmpID = #{executeempid}
			</if>
			<if test="billcode !=null and billcode !=''">
				and BillCode = #{billcode}
			</if>
			<if test="inputstate !=null ">
				and InputState = #{inputstate}
			</if>
		</where>
	</select>

	<select id="getMaxID" parameterType="Map" resultType="String">
		select Max(InputID) from DrugRepoInput
		<where>
			<if test="prefix !=null and prefix !=''">
				and InputID like #{prefix}
			</if>
		</where>
	</select>

	<select id="getMaxBillCode" resultType="String">
		select Max(BillCode) from
		DrugRepoInput
	</select>
</mapper>