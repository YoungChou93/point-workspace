<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.his.dao.baseinfo.RoleRightMapDao">
  <resultMap id="BaseResultMap" type="com.his.entity.baseinfo.RoleRightMap">
    <id column="ID" jdbcType="INTEGER" property="id" />
    <association property="role" column="RoleID" select="com.his.dao.baseinfo.RoleDao.selectByPrimaryKey"></association>
  	<association property="subsystemright" column="RightID" select="com.his.dao.baseinfo.SubSystemRightDao.selectByPrimaryKey"></association>
  </resultMap>
  
  <delete id="delete" parameterType="Map">
    delete from RoleRightMap
    where (( RightID=#{rightid} ) and (RoleID=#{roleid}) )
  </delete>
  
   <delete id="deleteByPrimaryKey" parameterType="Integer">
    delete from RoleRightMap where id=#{id}
  </delete>
  
  <delete id="deleteByMap" parameterType="Map" >
		delete  from RoleRightMap
		<where>
			<if test="rightid !=null and rightid !=''">
				and RightID=#{rightid}
			</if>
			<if test="roleid !=null and roleid !=''">
				and RoleID=#{roleid}
			</if>
		</where>
	</delete>
  
  <insert id="insert" parameterType="com.his.entity.baseinfo.LoginAccountRoleMap">
    insert into RoleRightMap (RoleID,RightID)
    values (#{role.roleid,jdbcType=VARCHAR},#{subsystemright.rightid,jdbcType=VARCHAR})
  </insert>
  
	<select id="findRoleRightMap" parameterType="Map" resultMap="BaseResultMap">
		select * from RoleRightMap
		<where>
			<!-- 查询某个角色拥有的权限 -->
			<if test="roleid!=null and roleid!=''">
				and RoleID=#{roleid}
			</if>
			<!-- rightid & roleid 都存在时，查询某映射关系是否存在 -->
			<if test="rightid!=null and rightid!=''">
				and RightID=#{rightid}
			</if>
		</where>
		<if test="start!=null and size!=null">
			order by ID offset ${start} rows fetch next ${size} rows only
		</if>
	</select>
	
	<select id="selectByID" parameterType="java.lang.Integer" resultMap="BaseResultMap">
	    select ID,RoleID,RightID
	    from RoleRightMap
	    where ID = #{id,jdbcType=VARCHAR}
  </select>
  
  	<select id="selectByIDtmp" parameterType="java.lang.Integer" resultType="String">
	    select RoleID
	    from RoleRightMap
	    where ID = #{id,jdbcType=VARCHAR}
  </select>
  
  	<select id="getSubSystemExisting" parameterType="Map" resultMap="BaseResultMap">
		select * from RoleRightMap
		<where>
			<if test="roleid!=null and roleid!=''">
				and RoleID=#{roleid}
			</if>
			<if test="rightid!=null and rightid!=''">
				and RightID like #{rightid}
			</if>
		</where>
	</select>
</mapper>